# Real-Time Ability Status Updates

## Overview

The Codex now features real-time ability status updates with multi-user support. When a user approves or edits an ability, all connected users see the checkmark update instantly without needing to refresh.

## How It Works

### 1. Optimistic Updates
- When a user approves/edits an ability, the UI updates immediately
- The change is stored locally and marked as "pending"
- A pulsing indicator shows the sync is in progress

### 2. Smart Polling
The system uses intelligent polling intervals:
- **30 seconds** - Default idle polling
- **5 seconds** - When recent activity is detected
- **2 seconds** - When the current user has pending changes
- Uses ETag headers to minimize bandwidth

### 3. Multi-User Awareness
- Detects when other users make changes
- Shows "Other users active" indicator
- Automatically syncs changes from all users
- Prevents conflicts by checking server state

### 4. Visual Feedback
- **‚úÖ** - Reviewed/approved ability
- **üü†** - Written but needs review
- **‚è≥** - Pending sync or not written
- Smooth animations when status changes
- Pulsing dot for pending changes

## Components

### useAbilityStatus.js
- Reactive store for ability statuses
- Handles polling and synchronization
- Manages local overrides and reconciliation
- Provides real-time status updates

### SidebarEnhancer.vue
- Enhances VitePress sidebar with live updates
- Adds data attributes for CSS targeting
- Shows multi-user activity indicator
- Updates checkmarks dynamically

### InlineAbilityEditor.vue
- Integrates with ability status store
- Performs optimistic updates on save/approve
- Shows real-time reviewed status

## Testing Multi-User Scenarios

1. Open the Codex in two different browsers/tabs
2. Approve an ability in one tab
3. Watch the checkmark update in the other tab within 5 seconds
4. Check the activity indicator shows "Other users active"

## Technical Details

- Status data stored in `ability-status.json`
- Generated by GitHub Actions on ability file changes
- Includes timestamp for change detection
- Local state persisted to localStorage
- Cross-tab synchronization via storage events

## Future Enhancements

For true real-time updates (sub-second), consider:
- WebSocket server (e.g., Cloudflare Durable Objects)
- Server-Sent Events (SSE)
- GitHub webhooks with push notifications

The current polling approach provides a good balance of real-time feel and infrastructure simplicity.